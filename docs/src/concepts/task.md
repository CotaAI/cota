# Task (ä»»åŠ¡ç¼–æ’)

Taskæ˜¯COTAæ¡†æ¶ä¸­çš„é«˜çº§ä»»åŠ¡ç¼–æ’å™¨ï¼Œé€šè¿‡åè°ƒå¤šä¸ªAgentæ¥å®Œæˆå¤æ‚çš„å¤šæ­¥éª¤ã€å¤šè§’è‰²ä»»åŠ¡ã€‚å®ƒæä¾›äº†çµæ´»çš„ä»»åŠ¡è§„åˆ’ã€å¹¶å‘æ‰§è¡Œå’ŒçŠ¶æ€ç®¡ç†èƒ½åŠ›ï¼Œæ˜¯æ„å»ºå¤æ‚å¯¹è¯åœºæ™¯å’Œå¤šAgentåä½œç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. å¤šAgentç¼–æ’
- **Agentç®¡ç†**: ç»Ÿä¸€ç®¡ç†å¤šä¸ªä¸“é—¨åŒ–çš„Agentå®ä¾‹
- **è§’è‰²åˆ†é…**: ä¸ºä¸åŒAgentåˆ†é…ç‰¹å®šçš„è§’è‰²å’ŒèŒè´£
- **åä½œæœºåˆ¶**: åè°ƒAgentä¹‹é—´çš„äº¤äº’å’Œæ•°æ®ä¼ é€’

### 2. ä»»åŠ¡è§„åˆ’
- **é™æ€è§„åˆ’**: é€šè¿‡é¢„å®šä¹‰çš„plansé…ç½®ä»»åŠ¡æ‰§è¡Œé¡ºåº
- **åŠ¨æ€è§„åˆ’**: ä½¿ç”¨LLMæ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
- **ä¾èµ–ç®¡ç†**: æ”¯æŒä»»åŠ¡é—´çš„ä¾èµ–å…³ç³»å’Œæ‰§è¡Œæ¡ä»¶

### 3. å¹¶å‘æ‰§è¡Œ
- **DAGæ‰§è¡Œ**: åŸºäºæœ‰å‘æ— ç¯å›¾(DAG)çš„å¹¶å‘ä»»åŠ¡æ‰§è¡Œ
- **çŠ¶æ€è·Ÿè¸ª**: å®æ—¶è·Ÿè¸ªä»»åŠ¡çŠ¶æ€ï¼ˆpending/completedï¼‰
- **èµ„æºæ§åˆ¶**: é€šè¿‡ä¿¡å·é‡æ§åˆ¶å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡æ•°é‡

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### Taskç»„ä»¶ç»“æ„

```
Task
â”œâ”€â”€ Description (ä»»åŠ¡æè¿°)
â”œâ”€â”€ Prompt (LLMè§„åˆ’æç¤ºè¯)
â”œâ”€â”€ Agents (ä»£ç†é›†åˆ)
â”‚   â”œâ”€â”€ Agent01 (è§’è‰²1)
â”‚   â”œâ”€â”€ Agent02 (è§’è‰²2)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Plans (æ‰§è¡Œè®¡åˆ’)
â”‚   â”œâ”€â”€ Task1 (å­ä»»åŠ¡1)
â”‚   â”œâ”€â”€ Task2 (å­ä»»åŠ¡2)
â”‚   â””â”€â”€ Dependencies (ä¾èµ–å…³ç³»)
â””â”€â”€ LLM (è§„åˆ’è¯­è¨€æ¨¡å‹)
```

### æ‰§è¡Œæ¨¡å¼

COTA Taskæ”¯æŒä¸¤ç§æ‰§è¡Œæ¨¡å¼ï¼š

#### 1. é¢„å®šä¹‰è®¡åˆ’æ¨¡å¼ (Plans-based)

ä½¿ç”¨é™æ€é…ç½®çš„DAGç»“æ„å®šä¹‰ä»»åŠ¡æ‰§è¡Œæµç¨‹ï¼š

```yaml
# task.yml
plans:
  - name: task1
    agent: doctor_agent
    startquery: "ç”¨æˆ·å’¨è¯¢ï¼šæˆ‘å®¶çŒ«å’ªæ‹‰è‚šå­äº†"
    dependencies: []
  
  - name: task2
    agent: user_agent  
    startquery: "ç»§ç»­è¯¢é—®ï¼šè¿˜æœ‰å…¶ä»–ç—‡çŠ¶å—ï¼Ÿ"
    dependencies: [task1]
    
  - name: task3
    agent: doctor_agent
    startquery: "æä¾›å»ºè®®ï¼šå»ºè®®åšè¿›ä¸€æ­¥æ£€æŸ¥"
    dependencies: [task2]
```

#### 2. LLMåŠ¨æ€è§„åˆ’æ¨¡å¼ (Prompt-based)

é€šè¿‡å¤§è¯­è¨€æ¨¡å‹åŠ¨æ€ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼š

```yaml
# task.yml  
prompt: |
  ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡è§„åˆ’å™¨ï¼Œæ ¹æ®ä»»åŠ¡æè¿°å’Œå†å²å¯¹è¯ï¼Œé€‰æ‹©ä¸‹ä¸€æ­¥æŒ‡æ´¾å“ªä¸ªagentæ¥æ‰§è¡Œ
  
  ä»»åŠ¡æè¿°ï¼š
  {{task_description}}
  
  agentsæè¿°ä¸º: 
  {{agent_description}}
  
  è¯·æ ¹æ®å½“å‰çš„å¯¹è¯çŠ¶æ€ï¼š
  {{history_messages}}
  
  è¯·æŒ‡æ´¾ä¸‹ä¸€æ­¥agentï¼Œè¯·æŒ‰ç…§å¦‚ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
  {"agent": "<é€‰æ‹©çš„agentçš„åå­—>"}
```

## ğŸ“ é¡¹ç›®ç»“æ„

### Taské¡¹ç›®ç›®å½•ç»“æ„

```
multi_agent_task/
â”œâ”€â”€ task.yml              # ä»»åŠ¡é…ç½®æ–‡ä»¶
â”œâ”€â”€ endpoints.yml         # ç«¯ç‚¹é…ç½®æ–‡ä»¶
â””â”€â”€ agents/              # ä»£ç†ç›®å½•
    â”œâ”€â”€ doctor_agent/    # ä»£ç†1 (å¦‚ï¼šåŒ»ç”Ÿè§’è‰²)
    â”‚   â”œâ”€â”€ agent.yml    # ä»£ç†é…ç½®
    â”‚   â””â”€â”€ endpoints.yml # ä»£ç†ç«¯ç‚¹é…ç½®
    â”œâ”€â”€ patient_agent/   # ä»£ç†2 (å¦‚ï¼šæ‚£è€…è§’è‰²)
    â”‚   â”œâ”€â”€ agent.yml    # ä»£ç†é…ç½®
    â”‚   â””â”€â”€ endpoints.yml # ä»£ç†ç«¯ç‚¹é…ç½®
    â””â”€â”€ ...
```

**æ³¨æ„**ï¼šTaskåŠŸèƒ½ç›®å‰å¤„äºå¼€å‘é˜¶æ®µï¼Œä¸»è¦ç”¨äºå¤æ‚çš„å¤šAgentåä½œåœºæ™¯ã€‚å¯¹äºç®€å•çš„å•Agentåº”ç”¨ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨Agentæ¨¡å¼ã€‚

### é…ç½®æ–‡ä»¶è¯¦è§£

#### task.yml - ä»»åŠ¡é…ç½®

```yaml
# ä»»åŠ¡æè¿°
description: "æ¨¡æ‹Ÿä¸€æ®µç”¨æˆ·å’Œå’¨è¯¢åŒ»ç”Ÿå® ç‰©é—®é¢˜çš„åœºæ™¯å¯¹è¯"

# LLMè§„åˆ’æç¤ºè¯ï¼ˆåŠ¨æ€æ¨¡å¼ï¼‰
prompt: |
  ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡è§„åˆ’å™¨ï¼Œæ ¹æ®ä»»åŠ¡æè¿°å’Œå†å²å¯¹è¯ï¼Œé€‰æ‹©ä¸‹ä¸€æ­¥æŒ‡æ´¾å“ªä¸ªagentæ¥æ‰§è¡Œ
  
  ä»»åŠ¡æè¿°ï¼š{{task_description}}
  agentsæè¿°ä¸º: {{agent_description}}
  
  è¯·æ ¹æ®å½“å‰çš„å¯¹è¯çŠ¶æ€ï¼š{{history_messages}}
  è¯·æŒ‡æ´¾ä¸‹ä¸€æ­¥agentï¼Œè¯·æŒ‰ç…§å¦‚ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
  {"agent": '<é€‰æ‹©çš„agentçš„åå­—>'}

# é¢„å®šä¹‰è®¡åˆ’ï¼ˆé™æ€æ¨¡å¼ï¼‰
plans:
  - name: consultation_start
    agent: user_agent
    startquery: "ä½ å®¶çŒ«ç”Ÿç—…äº†ï¼Œæ‹‰è‚šå­ï¼Œéœ€è¦æ‰¾åŒ»ç”Ÿå’¨è¯¢"
    dependencies: []
    
  - name: doctor_response
    agent: doctor_agent
    startquery: "/start"
    dependencies: [consultation_start]
    
  - name: follow_up_question
    agent: user_agent
    startquery: "è¿˜éœ€è¦åšä»€ä¹ˆæ£€æŸ¥å—ï¼Ÿ"
    dependencies: [doctor_response]
```

#### agent.yml - ä»£ç†é…ç½®

```yaml
# ä»£ç†åŸºæœ¬ä¿¡æ¯
system:
  name: doctor_agent
  description: "ä½ æ˜¯ä¸€åä¸“ä¸šçš„å® ç‰©åŒ»ç”Ÿï¼Œéœ€è¦è®¤çœŸè´Ÿè´£åœ°å›ç­”ç”¨æˆ·é—®é¢˜"

# å¯¹è¯é…ç½®
dialogue:
  use_proxy_user: true   # å¯ç”¨ä»£ç†ç”¨æˆ·æ¨¡å¼ç”¨äºå¤šAgentäº¤äº’
  max_proxy_step: 20     # ä»£ç†æ¨¡å¼ä¸‹çš„æœ€å¤§æ­¥éª¤æ•°
  max_tokens: 500        # LLMç”Ÿæˆæœ€å¤§ä»¤ç‰Œæ•°

# å¯¹è¯ç­–ç•¥
policies:
  - type: trigger
  - type: match
  - type: llm
    config:
      llms:
        - name: qwen-max
          action: BotUtter
        - name: deepseek-chat

# åŠ¨ä½œå®šä¹‰
actions:
  UserUtter:
    description: "ç”¨æˆ·å‘åŒ»ç”Ÿçš„æé—®"
    prompt: |
      ä½ æ˜¯ä¸€ä¸ªéœ€è¦åŒ»ç–—å¸®åŠ©çš„å® ç‰©ä¸»äººï¼Œå‘ä¸“ä¸šçš„å® ç‰©åŒ»ç”Ÿå’¨è¯¢é—®é¢˜ã€‚
      
      **å†å²å¯¹è¯ï¼š**
      {{history_messages}}
      
      **è¾“å‡ºæ ¼å¼ï¼š**
      ```json
      {
        "thought": "ä½ çš„å†…å¿ƒæƒ³æ³•",
        "text": "ä½ è¦è¯´çš„è¯", 
        "state": "continue/stop"
      }
      ```
    
  BotUtter:
    description: "ä¸“ä¸šåŒ»ç”Ÿå›å¤ç”¨æˆ·"
    prompt: |
      ä½ æ˜¯ä¸“ä¸šçš„å® ç‰©åŒ»ç”Ÿï¼Œéœ€è¦æ ¹æ®å¯¹è¯å†å²æä¾›ä¸“ä¸šå»ºè®®ã€‚
      
      **ä»»åŠ¡æè¿°ï¼š**
      {{task_description}}
      
      **å¯¹è¯å†å²ï¼š**
      {{history_actions_with_thoughts}}
      
      **è¾“å‡ºæ ¼å¼ï¼š**
      ```json
      {"thought": "<ä¸“ä¸šåˆ†æ>", "text": "<åŒ»ç–—å»ºè®®>"}
      ```
      
  Selector:
    description: "é€‰æ‹©åˆé€‚çš„Actions"
    prompt: |
      æ ¹æ®å½“å‰å¯¹è¯çŠ¶æ€é€‰æ‹©ä¸‹ä¸€ä¸ªæœ€åˆé€‚çš„Actionã€‚
      
      **å¯ç”¨Actionsï¼š**
      {{action_descriptions}}
      
      **å¯¹è¯çŠ¶æ€ï¼š**
      {{history_actions_with_thoughts}}
      
      **è¾“å‡ºæ ¼å¼ï¼š**
      ```json
      {"thought": "<åˆ†æè¿‡ç¨‹>", "action": "<åŠ¨ä½œåç§°>"}
      ```
```

## âš™ï¸ æ ¸å¿ƒAPI

### Taskç±»ä¸»è¦æ–¹æ³•

```python
from cota.task import Task

# 1. ä»è·¯å¾„åŠ è½½ä»»åŠ¡
task = Task.load_from_path("path/to/taskbot")

# 2. è¿è¡Œä»»åŠ¡ï¼ˆè‡ªåŠ¨é€‰æ‹©æ‰§è¡Œæ¨¡å¼ï¼‰
await task.run()

# 3. åŸºäºè®¡åˆ’è¿è¡Œï¼ˆé™æ€æ¨¡å¼ï¼‰
await task.run_with_plan(max_concurrent_tasks=5)

# 4. åŸºäºLLMè¿è¡Œï¼ˆåŠ¨æ€æ¨¡å¼ï¼‰
await task.run_with_llm()

# 5. ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
plans = await task.generate_plans()

# 6. æ‰§è¡Œå•ä¸ªå­ä»»åŠ¡
await task.execute_task(task_config)
```

### è¾…åŠ©æ–¹æ³•

```python
# è·å–ä»£ç†æè¿°
agent_desc = task.agent_description()

# è·å–ä»»åŠ¡æè¿°  
task_desc = task.task_description()

# è·å–å†å²æ¶ˆæ¯
history = task.history_messages()

# è·å–å½“å‰è®¡åˆ’
current_plan = task.current_plan()
```

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. åˆå§‹åŒ–é˜¶æ®µ

```mermaid
graph TD
    A[åŠ è½½task.yml] --> B[åŠ è½½endpoints.yml]
    B --> C[åˆå§‹åŒ–LLM]
    C --> D[åˆ›å»ºStore]
    D --> E[åŠ è½½æ‰€æœ‰Agent]
    E --> F[åˆ›å»ºTaskå®ä¾‹]
```

### 2. æ‰§è¡Œé˜¶æ®µ

#### é™æ€è®¡åˆ’æ‰§è¡Œæµç¨‹

```mermaid
graph TD
    A[æ£€æŸ¥plansé…ç½®] --> B[éªŒè¯DAGç»“æ„]
    B --> C[åˆå§‹åŒ–ä»»åŠ¡çŠ¶æ€]
    C --> D[æ‰¾åˆ°å°±ç»ªä»»åŠ¡]
    D --> E[å¹¶å‘æ‰§è¡Œå°±ç»ªä»»åŠ¡]
    E --> F[æ›´æ–°ä»»åŠ¡çŠ¶æ€]
    F --> G{è¿˜æœ‰å¾…æ‰§è¡Œä»»åŠ¡?}
    G -->|æ˜¯| D
    G -->|å¦| H[å®Œæˆ]
```

#### åŠ¨æ€è§„åˆ’æ‰§è¡Œæµç¨‹

```mermaid
graph TD
    A[æ£€æŸ¥prompté…ç½®] --> B[ç”Ÿæˆæ‰§è¡Œè®¡åˆ’]
    B --> C[æ‰§è¡Œè®¡åˆ’ä»»åŠ¡]
    C --> D[æ”¶é›†æ‰§è¡Œç»“æœ]
    D --> E[ç”Ÿæˆä¸‹ä¸€æ­¥è®¡åˆ’]
    E --> F[ç»§ç»­æ‰§è¡Œ]
```

### 3. ä»»åŠ¡æ‰§è¡Œç»†èŠ‚

æ¯ä¸ªå­ä»»åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

1. **å‚æ•°è§£æ**: è§£æstartqueryä¸­çš„æ§½ä½å’Œå‚æ•°
2. **æ¶ˆæ¯æ„å»º**: åˆ›å»ºMessageå¯¹è±¡
3. **Agentè°ƒç”¨**: é€šè¿‡Agentçš„processorå¤„ç†æ¶ˆæ¯
4. **ç»“æœæ”¶é›†**: æ”¶é›†Agentçš„å“åº”ç»“æœ
5. **çŠ¶æ€æ›´æ–°**: æ›´æ–°ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€

## ğŸš€ ä½¿ç”¨åœºæ™¯

### 1. å¤šè§’è‰²å¯¹è¯åœºæ™¯

**åœºæ™¯**: åŒ»æ‚£å’¨è¯¢å¯¹è¯
- **Agent01**: åŒ»ç”Ÿè§’è‰²ï¼Œæä¾›ä¸“ä¸šå»ºè®®
- **Agent02**: æ‚£è€…è§’è‰²ï¼Œæè¿°ç—‡çŠ¶å’Œæé—®
- **Task**: åè°ƒå¯¹è¯æµç¨‹ï¼Œç¡®ä¿ä¿¡æ¯ä¼ é€’

```yaml
description: "å® ç‰©åŒ»ç–—å’¨è¯¢å¯¹è¯åœºæ™¯"
agents:
  - doctor_agent: ä¸“ä¸šå® ç‰©åŒ»ç”Ÿ
  - patient_agent: å® ç‰©ä¸»äºº
```

### 2. ä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–

**åœºæ™¯**: å®¢æœå¤„ç†æµç¨‹
- **Agent01**: é—®é¢˜åˆ†ç±»å™¨
- **Agent02**: æŠ€æœ¯æ”¯æŒä¸“å®¶
- **Agent03**: å”®åæœåŠ¡ä¸“å®¶
- **Task**: æ ¹æ®é—®é¢˜ç±»å‹è·¯ç”±åˆ°ç›¸åº”ä¸“å®¶

### 3. æ•™å­¦è¾…å¯¼ç³»ç»Ÿ

**åœºæ™¯**: åœ¨çº¿æ•™å­¦
- **Agent01**: æ•™å¸ˆè§’è‰²ï¼Œè®²è§£çŸ¥è¯†ç‚¹
- **Agent02**: å­¦ç”Ÿè§’è‰²ï¼Œæé—®å’Œåé¦ˆ
- **Agent03**: è¯„ä¼°å™¨ï¼Œè¯„ä¼°å­¦ä¹ æ•ˆæœ
- **Task**: åè°ƒæ•™å­¦æµç¨‹

### 4. æ¸¸æˆNPCç³»ç»Ÿ

**åœºæ™¯**: è§’è‰²æ‰®æ¼”æ¸¸æˆ
- **å¤šä¸ªNPC Agent**: ä¸åŒæ€§æ ¼å’ŒèŒä¸šçš„NPC
- **Task**: æ ¹æ®æ¸¸æˆæƒ…èŠ‚å®‰æ’NPCäº¤äº’

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶å‘æ§åˆ¶

```python
# æ§åˆ¶æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°
await task.run_with_plan(max_concurrent_tasks=3)

# ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶èµ„æº
semaphore = asyncio.Semaphore(max_concurrent_tasks)
```

### 2. å†…å­˜ç®¡ç†

- **Agentå¤ç”¨**: ç›¸åŒé…ç½®çš„Agentå®ä¾‹å¤ç”¨
- **çŠ¶æ€æ¸…ç†**: åŠæ—¶æ¸…ç†å®Œæˆä»»åŠ¡çš„çŠ¶æ€æ•°æ®
- **è¿æ¥æ± **: æ•°æ®åº“å’ŒHTTPè¿æ¥å¤ç”¨

### 3. é”™è¯¯å¤„ç†

```python
try:
    await asyncio.gather(*tasks)
except Exception as e:
    logger.error(f"Error executing tasks: {e}")
    # å®ç°é”™è¯¯æ¢å¤é€»è¾‘
    raise
```

## ğŸ› ï¸ æœ€ä½³å®è·µ

### 1. ä»»åŠ¡è®¾è®¡åŸåˆ™

- **å•ä¸€èŒè´£**: æ¯ä¸ªAgentæ‰¿æ‹…æ˜ç¡®çš„å•ä¸€èŒè´£
- **æ¾è€¦åˆ**: Agentä¹‹é—´é€šè¿‡Messageæ¾æ•£è€¦åˆ
- **å¯æµ‹è¯•**: æ¯ä¸ªAgentéƒ½å¯ç‹¬ç«‹æµ‹è¯•
- **å¯æ‰©å±•**: æ”¯æŒåŠ¨æ€æ·»åŠ æ–°çš„Agentç±»å‹

### 2. é…ç½®ç®¡ç†

- **ç¯å¢ƒéš”ç¦»**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„endpointsé…ç½®
- **æ•æ„Ÿä¿¡æ¯**: ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
- **ç‰ˆæœ¬æ§åˆ¶**: é…ç½®æ–‡ä»¶çº³å…¥ç‰ˆæœ¬æ§åˆ¶ç®¡ç†

### 3. ç›‘æ§å’Œè°ƒè¯•

```python
# å¯ç”¨è¯¦ç»†æ—¥å¿—
import logging
logging.getLogger('cota.task').setLevel(logging.DEBUG)

# ç›‘æ§ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€
logger.debug(f"Task {task_name} status: {status}")
logger.debug(f"Agent response: {response}")
```

### 4. é”™è¯¯æ¢å¤

- **é‡è¯•æœºåˆ¶**: å¯¹å¤±è´¥çš„ä»»åŠ¡å®ç°é‡è¯•
- **é™çº§ç­–ç•¥**: å½“æŸä¸ªAgentä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†
- **æ£€æŸ¥ç‚¹**: åœ¨å…³é”®èŠ‚ç‚¹ä¿å­˜æ‰§è¡ŒçŠ¶æ€

## ğŸ” è°ƒè¯•æŒ‡å—

### å¸¸è§é—®é¢˜æ’æŸ¥

1. **DAGéªŒè¯å¤±è´¥**
   ```python
   # æ£€æŸ¥plansä¸­æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–
   from cota.utils.common import is_dag
   if not is_dag(plans):
       print("Plans contain circular dependencies")
   ```

2. **Agentåˆå§‹åŒ–å¤±è´¥**
   ```python
   # æ£€æŸ¥Agenté…ç½®æ–‡ä»¶
   agent_config = read_yaml_from_path("agent.yml")
   print("Agent config:", agent_config)
   ```

3. **LLMè§„åˆ’å¤±è´¥**
   ```python
   # æ£€æŸ¥promptæ¨¡æ¿å’Œå˜é‡æ›¿æ¢
   formatted_prompt = task.format_prompt(task.prompt)
   print("Formatted prompt:", formatted_prompt)
   ```

### æ€§èƒ½ç›‘æ§

```python
import time

# ç›‘æ§ä»»åŠ¡æ‰§è¡Œæ—¶é—´
start_time = time.time()
await task.run()
execution_time = time.time() - start_time
logger.info(f"Task execution time: {execution_time:.2f}s")
```

## ğŸŒŸ æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰ä»»åŠ¡ç±»å‹

å¯ä»¥ç»§æ‰¿Taskç±»å®ç°ç‰¹å®šé¢†åŸŸçš„ä»»åŠ¡ç¼–æ’å™¨ï¼š

```python
from cota.task import Task

class GameTask(Task):
    """æ¸¸æˆåœºæ™¯ä»»åŠ¡ç¼–æ’å™¨"""
    
    async def run_game_scenario(self):
        # å®ç°æ¸¸æˆç‰¹å®šçš„æ‰§è¡Œé€»è¾‘
        pass
    
    def get_npc_agent(self, npc_type: str):
        # æ ¹æ®NPCç±»å‹è·å–å¯¹åº”çš„Agent
        return self.agents.get(f"{npc_type}_agent")
```

### æ’ä»¶é›†æˆ

Taskä¸COTAå…¶ä»–ç»„ä»¶çš„é›†æˆï¼š

- **Agent**: ç®¡ç†å’Œè°ƒåº¦å¤šä¸ªæ™ºèƒ½ä»£ç†
- **DST**: è·Ÿè¸ªæ¯ä¸ªAgentçš„å¯¹è¯çŠ¶æ€
- **DPL**: ä¸ºæ¯ä¸ªAgentæä¾›å†³ç­–æ”¯æŒ
- **Store**: å…±äº«ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æ•°æ®
- **LLM**: æä¾›åŠ¨æ€è§„åˆ’å’Œå†³ç­–èƒ½åŠ›

---

Taskä½œä¸ºCOTAçš„ä»»åŠ¡ç¼–æ’æ ¸å¿ƒï¼Œä¸ºæ„å»ºå¤æ‚çš„å¤šAgentåä½œç³»ç»Ÿæä¾›äº†å¼ºå¤§è€Œçµæ´»çš„åŸºç¡€è®¾æ–½ï¼Œæ˜¯å®ç°é«˜çº§AIåº”ç”¨åœºæ™¯çš„å…³é”®ç»„ä»¶ã€‚
